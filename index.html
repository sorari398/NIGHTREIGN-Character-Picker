<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Ç≠„É£„É©ÊäΩÈÅ∏„Ç∑„Çπ„ÉÜ„É† Ver.3.5</title>
    <style>
        :root {
            --primary: #e94560;
            --bg: #1a1a2e;
            --card: #16213e;
            --accent: #0f3460;
            --text: #ffffff;
            --discord: #5865F2;
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            background: var(--card);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
            width: 100%;
            max-width: 480px;
            border: 1px solid rgba(233, 69, 96, 0.3);
        }

        h1 { color: var(--primary); text-align: center; letter-spacing: 3px; margin-bottom: 1.5rem; text-transform: uppercase; }

        .discord-settings {
            background: rgba(88, 101, 242, 0.1);
            border: 1px dashed var(--discord);
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 1.5rem;
        }
        .discord-settings label { font-size: 0.75rem; color: var(--discord); font-weight: bold; display: block; margin-bottom: 5px; }
        
        input[type="text"], input[type="password"] {
            width: 100%;
            padding: 12px;
            margin-bottom: 10px;
            background: var(--accent);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: #fff;
            box-sizing: border-box;
        }

        .option-group {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1.5rem;
            padding: 12px;
            background: rgba(15, 52, 96, 0.8);
            border-radius: 12px;
            cursor: pointer;
        }
        .option-group input { margin-right: 12px; width: 18px; height: 18px; cursor: pointer; }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 18px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
            box-shadow: 0 4px 0 #950740;
            transition: 0.1s;
        }
        button:active { transform: translateY(3px); box-shadow: 0 1px 0 #950740; }

        #result { margin-top: 2rem; display: flex; flex-direction: column; gap: 12px; }
        .result-card {
            background: var(--accent);
            border-radius: 15px;
            display: flex;
            align-items: center;
            padding: 12px;
            animation: slideUp 0.3s ease-out forwards;
            border-left: 5px solid var(--primary);
        }
        @keyframes slideUp { from { transform: translateY(10px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .char-img { width: 65px; height: 65px; border-radius: 8px; object-fit: cover; margin-right: 15px; background: #222; }
        .info { flex-grow: 1; }
        .user-label { font-size: 0.7rem; color: #95a5a6; display: block; }
        .char-name { font-size: 1.2rem; font-weight: bold; color: #fff; }
        .duplicate-badge { background: #ff9f43; color: #000; font-size: 0.6rem; padding: 2px 6px; border-radius: 4px; margin-left: 8px; }
    </style>
</head>
<body>

<div class="container">
    <h1>UNIT DISPATCH</h1>
    
    <div class="discord-settings">
        <label>DISCORD WEBHOOK URL</label>
        <input type="password" id="webhookUrl" placeholder="URL„ÇíË≤º„Çä‰ªò„Åë" >
    </div>

    <div class="input-section">
        <input type="text" id="user1" placeholder="Operator 1" value="Player 1">
        <input type="text" id="user2" placeholder="Operator 2" value="Player 2">
        <input type="text" id="user3" placeholder="Operator 3" value="Player 3">
    </div>

    <div class="option-group" onclick="document.getElementById('allowDupes').click(); event.stopPropagation();">
        <input type="checkbox" id="allowDupes" onclick="event.stopPropagation();">
        <label for="allowDupes" style="cursor:pointer; font-weight:bold;">Âêå‰∏Ä„Ç≠„É£„É©„ÅÆÈáçË§á„ÇíË®±ÂèØ„Åô„Çã</label>
    </div>

    <button onclick="pickCharacters()">ÊäΩÈÅ∏ÈñãÂßã & ÈÄöÁü•</button>

    <div id="result"></div>
</div>

<script>
    const charData = {
        "ËøΩË∑°ËÄÖ": "stalker.jpg",
        "ÂÆàË≠∑ËÄÖ": "guardian.jpg",
        "ÈâÑ„ÅÆÁõÆ": "iron_eye.jpg",
        "„É¨„Éá„Ç£": "lady.jpg",
        "ÁÑ°È†ºÊº¢": "rogue.jpg",
        "Âæ©ËÆêËÄÖ": "avenger.jpg",
        "Èö†ËÄÖ": "hermit.jpg",
        "Âü∑Ë°åËÄÖ": "executor.jpg",
        "Â≠¶ËÄÖ": "scholar.jpg",
        "Ëë¨ÂÑÄÂ±ã": "undertaker.jpg"
    };

    const characters = Object.keys(charData);

    async function sendToDiscord(webhookUrl, userNames, selectedList) {
        if (!webhookUrl) return;

        // GitHub Pages‰∏ä„ÅÆÁîªÂÉè„ÅÆÁµ∂ÂØæ„Éë„Çπ„ÇíÁîüÊàê
        const baseUrl = window.location.href.split('index.html')[0];

        const fields = userNames.map((name, i) => ({
            name: name,
            value: `‚û° **${selectedList[i]}**`,
            inline: true
        }));

        const payload = {
            embeds: [{
                title: "üéØ „É¶„Éã„ÉÉ„ÉàÈÅ∏Âá∫ÂÆå‰∫Ü",
                color: 0xe94560,
                fields: fields,
                // 1‰∫∫ÁõÆ„ÅÆÁîªÂÉè„ÇíÂ§ß„Åç„ÅèË°®Á§∫
                image: { url: baseUrl + charData[selectedList[0]] },
                // 2‰∫∫ÁõÆ„ÅÆÁîªÂÉè„ÇíÂè≥‰∏ä„Å´Â∞è„Åï„ÅèË°®Á§∫
                thumbnail: { url: baseUrl + charData[selectedList[1]] },
                footer: { text: "Character Selection System" },
                timestamp: new Date()
            }]
        };

        try {
            await fetch(webhookUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
        } catch (e) {
            console.error("DiscordÈÄÅ‰ø°„Ç®„É©„Éº:", e);
        }
    }

    function pickCharacters() {
        const resultDiv = document.getElementById('result');
        const allowDupes = document.getElementById('allowDupes').checked;
        const webhookUrl = document.getElementById('webhookUrl').value;
        resultDiv.innerHTML = ''; 

        const userNames = [
            document.getElementById('user1').value || "Player 1",
            document.getElementById('user2').value || "Player 2",
            document.getElementById('user3').value || "Player 3"
        ];

        let selectedList = [];
        if (allowDupes) {
            for (let i = 0; i < 3; i++) {
                selectedList.push(characters[Math.floor(Math.random() * characters.length)]);
            }
        } else {
            const shuffled = [...characters].sort(() => 0.5 - Math.random());
            selectedList = shuffled.slice(0, 3);
        }

        selectedList.forEach((charName, index) => {
            setTimeout(() => {
                const card = document.createElement('div');
                card.className = 'result-card';
                const isDuplicate = selectedList.filter(x => x === charName).length > 1;
                const dupeTag = (allowDupes && isDuplicate) ? '<span class="duplicate-badge">DUPLICATE</span>' : '';

                card.innerHTML = `
                    <img src="${charData[charName]}" class="char-img" 
                         onerror="this.src='https://via.placeholder.com/65/222/e94560?text=${charName.substring(0,1)}'">
                    <div class="info">
                        <span class="user-label">${userNames[index]}</span>
                        <span class="char-name">${charName}${dupeTag}</span>
                    </div>
                `;
                resultDiv.appendChild(card);
            }, index * 200);
        });

        sendToDiscord(webhookUrl, userNames, selectedList);
    }
</script>

</body>
</html>
